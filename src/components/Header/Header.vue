<template>

  <!-- 
    TODO: 
      1. avatar color
      2. adaptive design
  -->
  <div :class="{ wrapper: scrolledY }">
    <div class="container flex vcenter jcsb" :class="{ 'white-logo': this.background ==='white' }">
      <div class="navigation flex vcenter gap-1">
        <router-link :to="{name: 'home'}">
          <!-- <img src="@/assets/img/logo.svg" alt="Competence"> -->
          <svg width="286" height="75" fill="none">
            <path id="logo" fill="#E0E0E0" fill-rule="evenodd" clip-rule="evenodd" d="M50.5847 25.2981C34.9731 10.2726 30.8117 2.17206 30.6825 0C30.1225 2.64054 29.752 9.65928 32.7503 16.6099C34.3344 20.2822 37.9735 23.5437 41.6277 26.8188C46.6189 31.2922 51.6386 35.7909 51.4893 41.3969C51.2309 51.1073 42.8306 54.4293 38.8243 54.046C35.6193 53.7393 33.4395 51.5332 32.7503 50.4685C32.7503 50.4685 33.3964 60.9455 45.9322 60.5622C58.468 60.1789 70.0992 44.0801 50.5847 25.2981ZM11.9434 23.7649C22.1788 14.1567 27.4085 6.64395 28.744 4.08859C28.744 11.5131 30.1188 14.1348 32.0967 17.9064C32.4674 18.6133 32.8592 19.3605 33.2672 20.1874C34.4233 22.5304 37.4924 25.2312 40.6824 28.0384C44.6247 31.5075 48.7514 35.139 49.6801 38.4583C51.3068 44.273 49.0562 46.6136 46.8 48.9601L46.6551 49.1108L46.5784 49.1908C48.5169 44.3356 44.2522 39.2249 41.1505 37.6917C38.6692 36.4651 33.2241 31.7291 30.8117 29.5145C29.9933 30.4089 27.3999 32.8876 23.5746 35.6474C22.7476 36.244 21.8588 36.8291 20.9502 37.4273C16.6054 40.2877 11.8093 43.4452 11.168 49.5741C10.3926 56.9847 15.4328 61.4566 22.6699 66.3118C28.4597 70.1959 29.7348 73.3816 29.6486 74.4889C29.6486 74.4889 22.5407 71.8058 11.9434 66.3118C1.34615 60.8177 0.183034 50.4685 0.0537993 48.0409L0.0466433 47.9093C-0.098062 45.2748 -0.631179 35.5689 11.9434 23.7649ZM60.7943 52.2572C59.0281 55.9199 53.2986 63.0153 44.5107 62.0954C33.5257 60.9455 31.5872 54.9404 31.4579 50.4685C31.3287 45.9966 35.2057 43.4412 38.1781 44.7189C38.1781 43.6968 37.2735 43.1857 36.6273 42.9302L36.5914 42.8826C36.1703 42.3237 34.9936 40.7618 32.2333 40.8859C29.3902 41.0136 27.9686 42.9302 24.9962 47.402C24.575 48.0357 24.2057 48.613 23.8706 49.1367C21.8412 52.3088 21.0683 53.5168 17.6298 53.4072C14.4247 53.3049 12.9342 50.2129 12.5896 48.6797C11.7711 50.4685 11.2714 55.0681 15.8205 59.1567C17.5134 60.6783 19.4813 62.1206 21.4376 63.5544L21.4376 63.5544C26.0523 66.9366 30.6026 70.2717 31.3287 74.4889V75C32.2764 74.4463 34.6629 73.1857 36.6273 72.5724C39.0828 71.8058 50.5309 66.3118 53.0402 64.3952C55.0702 62.8447 60.1481 58.2623 60.7943 52.2572ZM76.0328 43.724C78.5288 46.244 81.6608 47.504 85.4288 47.504C87.7088 47.504 89.8088 46.976 91.7288 45.92C93.6728 44.84 95.1848 43.388 96.2648 41.564L91.9808 39.08C91.3808 40.184 90.4928 41.06 89.3168 41.708C88.1648 42.332 86.8688 42.644 85.4288 42.644C82.9808 42.644 81.0008 41.876 79.4888 40.34C78.0008 38.78 77.2568 36.8 77.2568 34.4C77.2568 31.976 78.0008 29.984 79.4888 28.424C81.0008 26.888 82.9808 26.12 85.4288 26.12C86.8688 26.12 88.1648 26.444 89.3168 27.092C90.4688 27.716 91.3568 28.592 91.9808 29.72L96.2648 27.236C95.1848 25.412 93.6728 23.972 91.7288 22.916C89.8088 21.836 87.7088 21.296 85.4288 21.296C81.6608 21.296 78.5288 22.556 76.0328 25.076C73.5608 27.548 72.3248 30.656 72.3248 34.4C72.3248 38.12 73.5608 41.228 76.0328 43.724ZM107.81 47.504C110.498 47.504 112.754 46.592 114.578 44.768C116.426 42.92 117.35 40.664 117.35 38C117.35 35.36 116.426 33.116 114.578 31.268C112.73 29.42 110.474 28.496 107.81 28.496C105.146 28.496 102.89 29.42 101.042 31.268C99.2181 33.092 98.3061 35.336 98.3061 38C98.3061 40.688 99.2181 42.944 101.042 44.768C102.866 46.592 105.122 47.504 107.81 47.504ZM107.81 42.968C106.418 42.968 105.254 42.5 104.318 41.564C103.406 40.604 102.95 39.416 102.95 38C102.95 36.584 103.406 35.396 104.318 34.436C105.254 33.5 106.418 33.032 107.81 33.032C109.202 33.032 110.366 33.5 111.302 34.436C112.238 35.372 112.706 36.56 112.706 38C112.706 39.44 112.238 40.628 111.302 41.564C110.366 42.5 109.202 42.968 107.81 42.968ZM145.493 30.512C144.269 29.168 142.625 28.496 140.561 28.496C138.161 28.496 136.373 29.36 135.197 31.088C134.165 29.36 132.533 28.496 130.301 28.496C128.045 28.496 126.377 29.3 125.297 30.908V29H120.653V47H125.297V36.884C125.297 35.588 125.597 34.592 126.197 33.896C126.821 33.176 127.649 32.816 128.681 32.816C129.641 32.816 130.385 33.116 130.913 33.716C131.441 34.316 131.705 35.156 131.705 36.236V47H136.349V36.884C136.349 35.564 136.637 34.556 137.213 33.86C137.813 33.164 138.641 32.816 139.697 32.816C140.657 32.816 141.401 33.116 141.929 33.716C142.457 34.316 142.721 35.156 142.721 36.236V47H147.365V35.912C147.365 33.656 146.741 31.856 145.493 30.512ZM168.013 31.268C166.309 29.42 164.245 28.496 161.821 28.496C159.301 28.496 157.357 29.372 155.989 31.124V29H151.345V54.2H155.989V44.876C157.357 46.628 159.301 47.504 161.821 47.504C164.269 47.504 166.333 46.592 168.013 44.768C169.741 42.944 170.605 40.688 170.605 38C170.605 35.36 169.741 33.116 168.013 31.268ZM160.957 43.076C159.517 43.076 158.329 42.608 157.393 41.672C156.457 40.712 155.989 39.488 155.989 38C155.989 36.512 156.457 35.3 157.393 34.364C158.329 33.404 159.517 32.924 160.957 32.924C162.397 32.924 163.585 33.404 164.521 34.364C165.481 35.3 165.961 36.512 165.961 38C165.961 39.488 165.481 40.712 164.521 41.672C163.585 42.608 162.397 43.076 160.957 43.076ZM177.841 39.908H191.413C191.533 39.14 191.593 38.504 191.593 38C191.593 35.312 190.729 33.056 189.001 31.232C187.321 29.408 185.149 28.496 182.485 28.496C179.677 28.496 177.397 29.408 175.645 31.232C173.869 33.056 172.981 35.312 172.981 38C172.981 40.736 173.881 43.004 175.681 44.804C177.481 46.604 179.869 47.504 182.845 47.504C186.301 47.504 188.917 46.22 190.693 43.652L186.949 41.492C186.037 42.692 184.693 43.292 182.917 43.292C180.133 43.292 178.441 42.164 177.841 39.908ZM186.949 36.308H177.769C178.033 35.156 178.573 34.268 179.389 33.644C180.205 32.996 181.237 32.672 182.485 32.672C183.589 32.672 184.537 32.984 185.329 33.608C186.145 34.232 186.685 35.132 186.949 36.308ZM204.639 33.464V29H200.571V23.96L195.927 25.364V29H192.795V33.464H195.927V40.952C195.927 43.448 196.587 45.176 197.907 46.136C199.251 47.072 201.495 47.36 204.639 47V42.788C203.751 42.836 203.007 42.848 202.407 42.824C201.807 42.776 201.351 42.608 201.039 42.32C200.727 42.032 200.571 41.576 200.571 40.952V33.464H204.639ZM211.311 39.908H224.883C225.003 39.14 225.063 38.504 225.063 38C225.063 35.312 224.199 33.056 222.471 31.232C220.791 29.408 218.619 28.496 215.955 28.496C213.147 28.496 210.867 29.408 209.115 31.232C207.339 33.056 206.451 35.312 206.451 38C206.451 40.736 207.351 43.004 209.151 44.804C210.951 46.604 213.339 47.504 216.315 47.504C219.771 47.504 222.387 46.22 224.163 43.652L220.419 41.492C219.507 42.692 218.163 43.292 216.387 43.292C213.603 43.292 211.911 42.164 211.311 39.908ZM220.419 36.308H211.239C211.503 35.156 212.043 34.268 212.859 33.644C213.675 32.996 214.707 32.672 215.955 32.672C217.059 32.672 218.007 32.984 218.799 33.608C219.615 34.232 220.155 35.132 220.419 36.308ZM243.209 30.476C241.961 29.156 240.341 28.496 238.349 28.496C235.877 28.496 234.089 29.336 232.985 31.016V29H228.341V47H232.985V37.28C232.985 35.816 233.333 34.712 234.029 33.968C234.749 33.2 235.721 32.816 236.945 32.816C238.049 32.816 238.913 33.14 239.537 33.788C240.185 34.436 240.509 35.348 240.509 36.524V47H245.153V35.948C245.153 33.644 244.505 31.82 243.209 30.476ZM250.918 44.768C252.742 46.592 255.01 47.504 257.722 47.504C259.45 47.504 261.034 47.084 262.474 46.244C263.938 45.404 265.066 44.264 265.858 42.824L261.826 40.52C261.466 41.264 260.914 41.852 260.17 42.284C259.45 42.692 258.622 42.896 257.686 42.896C256.294 42.896 255.142 42.44 254.23 41.528C253.318 40.568 252.862 39.392 252.862 38C252.862 36.56 253.318 35.384 254.23 34.472C255.142 33.536 256.294 33.068 257.686 33.068C258.598 33.068 259.414 33.284 260.134 33.716C260.878 34.148 261.43 34.736 261.79 35.48L265.786 33.14C265.042 31.724 263.95 30.596 262.51 29.756C261.07 28.916 259.474 28.496 257.722 28.496C255.01 28.496 252.742 29.408 250.918 31.232C249.118 33.056 248.218 35.312 248.218 38C248.218 40.688 249.118 42.944 250.918 44.768ZM271.993 39.908H285.565C285.685 39.14 285.745 38.504 285.745 38C285.745 35.312 284.881 33.056 283.153 31.232C281.473 29.408 279.301 28.496 276.637 28.496C273.829 28.496 271.549 29.408 269.797 31.232C268.021 33.056 267.133 35.312 267.133 38C267.133 40.736 268.033 43.004 269.833 44.804C271.633 46.604 274.021 47.504 276.997 47.504C280.453 47.504 283.069 46.22 284.845 43.652L281.101 41.492C280.189 42.692 278.845 43.292 277.069 43.292C274.285 43.292 272.593 42.164 271.993 39.908ZM281.101 36.308H271.921C272.185 35.156 272.725 34.268 273.541 33.644C274.357 32.996 275.389 32.672 276.637 32.672C277.741 32.672 278.689 32.984 279.481 33.608C280.297 34.232 280.837 35.132 281.101 36.308Z"/>
          </svg>
        </router-link>
        <nav class="grey__darken-1--text flex">
          <div class=" dropdown-item" :class="{ active: activeIndex == 1 }" @click="toggleDropdown(1)">
            Продукт
            <ul class="grey__darken-1--text dropdown-content">
              <router-link class="description grey__darken-4--text" :to="{name: 'how-it-works'}">Как это работает</router-link>
              <router-link class="description grey__darken-4--text" :to="{name: 'features'}">Функционал</router-link>
            </ul>
          </div>
          <div class="dropdown-item" :class="{ active: activeIndex == 2 }" @click="toggleDropdown(2)" >
            Решения
            <ul class="dropdown-content flex">
              <div class="item-title">
                <p class="bold grey__darken-4--text">Выберите свой бизнес.</p>
                <p class="description light">И узнайте как повысить эффективность</p>
              </div>
              <div class="item-links">
                <router-link class="description" :to="{name: 'retail'}">
                  <div class="item-body flex vcenter gap-0-5">
                    <img src="@/assets/img/retail.png" alt="Ритейл">
                    Ритейл
                  </div>
                </router-link>
                <router-link class="description" :to="{name: 'banking'}">
                  <div class="item-body flex vcenter gap-0-5">
                    <img src="@/assets/img/banking.png" alt="Банки">
                    Банки
                  </div>
                </router-link>
                <router-link class="description" :to="{name: 'corporate'}">
                  <div class="item-body flex vcenter gap-0-5">
                    <img src="@/assets/img/corporate.png" alt="Корп.">
                    Корп.
                  </div>
                </router-link>
                <router-link class="description" :to="{name: 'hospitality'}">
                  <div class="item-body flex vcenter gap-0-5">
                    <img src="@/assets/img/horeka.png" alt="ХоРеКа">
                    ХоРеКа
                  </div>
                </router-link>
              </div>
            </ul>
          </div>
          <div class="dropdown-item" :class="{ active: activeIndex == 3 }" @click="toggleDropdown(3)">
            Компания
            <ul class="grey__darken-1--text dropdown-content">
              <router-link class="description grey__darken-4--text" :to="{name: 'about'}">О нас</router-link>
              <router-link class="description grey__darken-4--text" :to="{name: 'partnership'}">Партнерская программа</router-link>
              <router-link class="description grey__darken-4--text" :to="{name: 'contacts'}">Контакты</router-link>
            </ul>
          </div>
          <router-link class="dropdown-item link" :to="{name: 'pricing'}">Цены</router-link>     
        </nav>
      </div>
      <div class="buttons flex gap-1-5">
        <router-link :to="{name: 'sign-in'}">
          <button class="button__outlined dark small">Войти</button>
        </router-link>
        <router-link :to="{name: 'sign-up'}">
          <button class="button__outlined small">Начать Бесплатно</button>
        </router-link>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  props: {
    background: String | 'black',
  },
  data() {
  return {
    activeIndex: null,
    scrolledY: null,
  }
  },
  mounted() {
  window.addEventListener('scroll', this.checkScroll)
  },
  methods: {
    toggleDropdown: function(index) {
      this.activeIndex == index ? (event.target.classList.remove('active'), this.activeIndex = null) : this.activeIndex = index;
    },
    checkScroll: function() {
      const scrollPosition = window.scrollY;
      scrollPosition > 40 ? this.scrolledY = true : this.scrolledY = false
    }
  }
}
</script>

<style lang="scss" scoped>
@import '@/assets/sass/colors';
.wrapper {
  position: fixed;
  width: 100%;
  // left: 0;
  // right: 0;
  top: 0;
  padding-top: 0.1rem;
  padding-right: 2.75rem;
  background-color: $grey-lighten-4;
  transition: $transition;

  svg path {
  transition: $transition;
  fill: $blue-grey-darken-4;
}

  nav, a {
    color: $grey-darken-4;

    &.link {
      &:hover {
        color: $indigo;
      }
    }
  }
}

.container {
  padding: 1rem 4rem;
  transition: $transition;

  &.white-logo {
    svg path {
      fill: $blue-grey-darken-4;
    }
  }
}

.dropdown-item {
  position: relative;
  cursor: pointer;
  padding: 0.625rem;
  border-radius: 4px;
  font-size: 1.3rem;

  &:hover {
    background-color: rgba($grey-darken-1, 0.1);
  }

  &.link {
    background-color: transparent;
  }

  &.active {  
    .dropdown-content {
      display: flex;
    }
  }

  .dropdown-content {
    display: none;
    flex-direction: column;
    background-color: $grey-lighten-5;
    border-radius: 4px;
    position: absolute;
    top: 3.5rem;
    white-space: nowrap;

    a {
      padding: 1rem 1.5rem;
      
      &:hover {
        color: $green;
        background-color: rgba($green, 0.2);
      }
    }

    .item-links {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 0.5rem;
    }

    .item-title {
      padding: 1.5rem;
      border-bottom: 1px solid $grey-lighten-2;
    }

    .item-body {
      img {
        height: 3.5rem;
      }
    }
  }
}
</style>